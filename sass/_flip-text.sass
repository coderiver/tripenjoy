.flip-text
  position: fixed
  z-index: 101
  top: 50%
  left: 50%
  margin-left: -268px
  margin-top: -37px
  font-size: 0
  white-space: nowrap

  $charwidth: 45px
  $charheight: 74px
  $dur: 0.3s
  $easing: linear
  // $easing: cubic-bezier(0.895, 0.03, 0.685, 0.22)

  .char
    display: inline-block
    vertical-align: middle
    position: relative
    margin-right: 5px
    width: $charwidth
    height: $charheight
    border-radius: 4px
    background: $orange
    color: #FFF
    font-size: 53px
    // line-height: $charheight
    line-height: $charheight - 3
    text-align: center
    text-transform: uppercase
    +perspective(150px)
    &:before
      content: ""
      position: absolute
      z-index: 2
      top: 50%
      margin-top: -1px
      left: 0
      right: 0
      height: 0
      border-top: 1px solid rgba(0,0,0,0.1)
      border-bottom: 1px solid rgba(255,255,255,0.2)

  .char__top,
  .char__bottom
    position: absolute
    left: 0
    right: 0
    overflow: hidden
    +transform-style(preserve-3d)
    -webkit-backface-visibility: hidden
    -moz-backface-visibility: hidden
    backface-visibility: hidden
    background: $orange
    &:before
      content: ""
      position: absolute
      z-index: 1
      left: 0
      right: 0
      height: 0
      border-top: 1px solid rgba(0,0,0,0.1)
      border-bottom: 1px solid rgba(255,255,255,0.2)
    &:after
      content: ""
      position: absolute
      z-index: 2
      top: 0
      left: 0
      right: 0
      bottom: 0
      background: rgba(0,0,0,0.3)
      opacity: 0
    span
      position: absolute
      left: 0
      right: 0
      width: $charwidth
      height: $charheight

  .char__top
    top: 0
    bottom: 50%
    border-top-left-radius: 4px
    border-top-right-radius: 4px
    -webkit-transform-origin: left bottom 0
    -moz-transform-origin: left bottom 0
    -ms-transform-origin: left bottom 0
    -o-transform-origin: left bottom 0
    transform-origin: left bottom 0
    +transform(rotateX(0deg))
    +animation(flip-char-top $dur $easing 10)
    &:before
      bottom: -1px
    span
      top: 0
    &:after
      +animation(to-bottom $dur $easing 10)

  .char__bottom
    top: 50%
    bottom: 0
    border-bottom-left-radius: 4px
    border-bottom-right-radius: 4px
    -webkit-transform-origin: left top 0
    -moz-transform-origin: left top 0
    -ms-transform-origin: left top 0
    -o-transform-origin: left top 0
    transform-origin: left top 0
    +transform(rotateX(90deg))
    +animation(flip-char-bottom $dur $easing 10)
    span
      bottom: 0
    &:before
      top: -1px
      display: none
    &:after
      +animation(to-top $dur $easing 10)


// animations
+keyframes(flip-char-top)
  0%
    +transform(rotateX(0deg))
    visibility: visible
  50%, 99%
    +transform(rotateX(-90deg))
  100%
    +transform(rotateX(-90deg))
    visibility: hidden

+keyframes(flip-char-bottom)
  0%, 50%
    +transform(rotateX(90deg))
    visibility: visible
  99%
    +transform(rotateX(0deg))
  100%
    +transform(rotateX(0deg))
    visibility: hidden

+keyframes(to-bottom)
  from
    opacity: 0
    top: 0
  to
    opacity: 1
    top: 5px

+keyframes(to-top)
  from
    opacity: 1
    bottom: 5px
  to
    opacity: 0
    bottom: 0

// animation delay for each char
@for $i from 2 to 20
  $delay: $i/2 + random(100)/100 +s
  .char:nth-child(#{$i})
    .char__top
      +animation-delay($delay)
      &:after
        +animation-delay($delay)
  .char:nth-child(#{$i})
    .char__bottom
      +animation-delay($delay)
      &:after
        +animation-delay($delay)